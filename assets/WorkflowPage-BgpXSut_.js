import{r as s,j as e,U as M,R as O,i as E,a as $,b as T,F as U,L as S}from"./index-CkN9guWE.js";const J=({onPresetSelect:v,selectedPreset:m})=>{const[y,o]=s.useState([]),[g,d]=s.useState("");s.useEffect(()=>{const a=localStorage.getItem("imageEditorPresets");if(a)try{o(JSON.parse(a))}catch(u){console.error("Failed to parse presets",u)}},[]);const f=y.filter(a=>a.name.toLowerCase().includes(g.toLowerCase()));return e.jsxs("div",{className:"preset-selector",style:{background:"rgba(255,255,255,0.03)",borderRadius:"8px",padding:"16px"},children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx("input",{type:"text",placeholder:"Search presets...",value:g,onChange:a=>d(a.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",background:"rgba(255,255,255,0.05)",border:"1px solid #4a5568",color:"#e0e0e0",fontSize:"14px"}})}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",paddingRight:"8px"},children:f.length===0?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#a0a0a0"},children:g?"No matching presets found":"No presets available"}):f.map(a=>e.jsxs("div",{onClick:()=>v(a),style:{padding:"12px",background:m?.id===a.id?"rgba(74, 158, 255, 0.2)":"rgba(255,255,255,0.05)",borderRadius:"6px",marginBottom:"8px",cursor:"pointer",border:m?.id===a.id?"1px solid #4a9eff":"1px solid transparent",transition:"all 0.2s ease"},onMouseOver:u=>{u.target.style.background=m?.id===a.id?"rgba(74, 158, 255, 0.3)":"rgba(255,255,255,0.08)"},onMouseOut:u=>{u.target.style.background=m?.id===a.id?"rgba(74, 158, 255, 0.2)":"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:"600",color:"#e0e0e0"},children:a.name}),e.jsx("span",{style:{fontSize:"12px",color:"#a0a0a0"},children:new Date(a.createdAt).toLocaleDateString()})]}),e.jsxs("div",{style:{marginTop:"6px",fontSize:"12px",color:"#a0a0a0"},children:[Object.keys(a.settings||{}).length," adjustments"]})]},a.id))})]})},q=({onSave:v,onCancel:m,initialWorkflow:y=null})=>{const[o,g]=s.useState({name:"",steps:[],...y||{}}),[d,f]=s.useState({type:"convert",settings:{}}),a=()=>{d.type&&(g(r=>({...r,steps:[...r.steps,{...d,id:Date.now()}]})),f({type:"convert",settings:{}}))},u=r=>{g(x=>({...x,steps:x.steps.filter(l=>l.id!==r)}))},h=()=>{o.name&&o.steps.length>0&&v(o)},b=(r,x)=>{f(l=>({...l,settings:{...l.settings,[r]:x}}))};return e.jsxs("div",{className:"workflow-builder",style:{background:"linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%)",borderRadius:"15px",padding:"24px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)",color:"#e0e0e0"},children:[e.jsx("h2",{style:{color:"#4a9eff",marginBottom:"24px",textAlign:"center",fontSize:"24px",fontWeight:"600"},children:y?"Edit Workflow":"Create New Workflow"}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#a0a0a0",fontWeight:"500"},children:"Workflow Name"}),e.jsx("input",{type:"text",value:o.name,onChange:r=>g(x=>({...x,name:r.target.value})),placeholder:"Enter workflow name",style:{width:"100%",padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid #4a5568",color:"#e0e0e0",fontSize:"16px"}})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h3",{style:{color:"#4a9eff",marginBottom:"16px",fontSize:"18px",fontWeight:"600"},children:"Add Processing Step"}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#a0a0a0",fontWeight:"500"},children:"Step Type"}),e.jsxs("select",{value:d.type,onChange:r=>f(x=>({...x,type:r.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid #4a5568",color:"#e0e0e0",fontSize:"16px"},children:[e.jsx("option",{value:"convert",children:"Convert Format"}),e.jsx("option",{value:"preset",children:"Apply Preset"}),e.jsx("option",{value:"resize",children:"Resize Image"}),e.jsx("option",{value:"watermark",children:"Add Watermark"})]})]}),d.type==="convert"&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#a0a0a0",fontWeight:"500"},children:"Output Format"}),e.jsxs("select",{value:d.settings.format||"jpeg",onChange:r=>b("format",r.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid #4a5568",color:"#e0e0e0",fontSize:"16px",marginBottom:"16px"},children:[e.jsx("option",{value:"jpeg",children:"JPEG"}),e.jsx("option",{value:"png",children:"PNG"}),e.jsx("option",{value:"webp",children:"WebP"})]}),d.settings.format==="jpeg"&&e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"8px",color:"#a0a0a0",fontWeight:"500"},children:["JPEG Quality: ",d.settings.quality||80,"%"]}),e.jsx(M,{min:1,max:100,value:d.settings.quality||80,onChange:r=>b("quality",r)})]})]}),d.type==="preset"&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#a0a0a0",fontWeight:"500"},children:"Select Preset"}),e.jsx(J,{onPresetSelect:r=>b("preset",r),selectedPreset:d.settings.preset})]}),d.type==="resize"&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#a0a0a0",fontWeight:"500"},children:"Max Dimension (px)"}),e.jsx("input",{type:"number",value:d.settings.dimension||1920,onChange:r=>b("dimension",parseInt(r.target.value)),style:{width:"100%",padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid #4a5568",color:"#e0e0e0",fontSize:"16px"}})]}),e.jsx("button",{onClick:a,disabled:!d.type,style:{width:"100%",padding:"12px",borderRadius:"8px",background:d.type?"linear-gradient(135deg, #4a9eff 0%, #3a8eed 100%)":"#4a5568",color:"#fff",border:"none",cursor:d.type?"pointer":"not-allowed",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:"Add Step"})]}),o.steps.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h3",{style:{color:"#4a9eff",marginBottom:"16px",fontSize:"18px",fontWeight:"600"},children:"Workflow Steps"}),e.jsx("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:"8px",padding:"16px"},children:o.steps.map((r,x)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",background:"rgba(255,255,255,0.05)",borderRadius:"6px",marginBottom:"8px"},children:[e.jsxs("div",{children:[e.jsxs("span",{style:{fontWeight:"600",color:"#4a9eff"},children:["Step ",x+1,": ",r.type]}),e.jsxs("div",{style:{fontSize:"14px",color:"#a0a0a0",marginTop:"4px"},children:[r.type==="convert"&&`Format: ${r.settings.format||"jpeg"}${r.settings.format==="jpeg"?`, Quality: ${r.settings.quality||80}%`:""}`,r.type==="preset"&&`Preset: ${r.settings.preset?.name||"None"}`,r.type==="resize"&&`Dimension: ${r.settings.dimension||1920}px`,r.type==="watermark"&&"Add watermark"]})]}),e.jsx("button",{onClick:()=>u(r.id),style:{background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",fontSize:"18px",padding:"4px"},children:"×"})]},r.id))})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{onClick:h,disabled:!o.name||o.steps.length===0,style:{flex:1,padding:"12px",borderRadius:"8px",background:o.name&&o.steps.length>0?"linear-gradient(135deg, #4a9eff 0%, #3a8eed 100%)":"#4a5568",color:"#fff",border:"none",cursor:o.name&&o.steps.length>0?"pointer":"not-allowed",fontSize:"16px",fontWeight:"600"},children:"Save Workflow"}),e.jsx("button",{onClick:m,style:{flex:1,padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.1)",color:"#e0e0e0",border:"1px solid #4a5568",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"Cancel"})]})]})},I=({onWorkflowSelect:v})=>{const[m,y]=s.useState([]),[o,g]=s.useState(!1),[d,f]=s.useState(null),[a,u]=s.useState("");s.useEffect(()=>{const l=localStorage.getItem("imageEditorWorkflows");if(l)try{y(JSON.parse(l))}catch(p){console.error("Failed to parse workflows",p)}},[]),s.useEffect(()=>{localStorage.setItem("imageEditorWorkflows",JSON.stringify(m))},[m]);const h=l=>{const p={id:Date.now(),...l,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};y(j=>{const k=j.findIndex(c=>c.id===p.id);if(k>=0){const c=[...j];return c[k]=p,c}else return[...j,p]}),g(!1),f(null)},b=l=>{y(p=>p.filter(j=>j.id!==l))},r=l=>{f(l),g(!0)},x=m.filter(l=>l.name.toLowerCase().includes(a.toLowerCase()));return e.jsxs("div",{className:"workflow-manager",style:{maxWidth:"1200px",margin:"0 auto",padding:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx("h2",{style:{color:"#fff",fontSize:"24px",fontWeight:"600"},children:"Workflow Manager"}),e.jsx("button",{onClick:()=>g(!0),style:{padding:"10px 20px",borderRadius:"8px",background:"linear-gradient(135deg, #4a9eff 0%, #3a8eed 100%)",color:"#fff",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:"Create Workflow"})]}),o?e.jsx(q,{onSave:h,onCancel:()=>{g(!1),f(null)},initialWorkflow:d}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx("input",{type:"text",placeholder:"Search workflows...",value:a,onChange:l=>u(l.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid #4a5568",color:"#e0e0e0",fontSize:"16px"}})}),x.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%)",borderRadius:"15px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)"},children:[e.jsx("h3",{style:{color:"#a0a0a0",marginBottom:"16px",fontSize:"18px"},children:a?"No matching workflows found":"No workflows created yet"}),e.jsx("p",{style:{color:"#6c757d",marginBottom:"24px"},children:a?"Try adjusting your search terms":"Create your first workflow to get started with batch processing"}),e.jsx("button",{onClick:()=>g(!0),style:{padding:"10px 20px",borderRadius:"8px",background:"linear-gradient(135deg, #4a9eff 0%, #3a8eed 100%)",color:"#fff",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"Create Workflow"})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:x.map(l=>e.jsxs("div",{style:{background:"linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%)",borderRadius:"15px",padding:"20px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)",transition:"all 0.3s ease"},onMouseOver:p=>{p.target.style.transform="translateY(-5px)",p.target.style.boxShadow="0 12px 40px rgba(0,0,0,0.4)"},onMouseOut:p=>{p.target.style.transform="translateY(0)",p.target.style.boxShadow="0 8px 32px rgba(0,0,0,0.3)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[e.jsx("h3",{style:{color:"#4a9eff",fontSize:"18px",fontWeight:"600",margin:0},children:l.name}),e.jsxs("span",{style:{color:"#a0a0a0",fontSize:"12px",background:"rgba(255,255,255,0.1)",padding:"4px 8px",borderRadius:"12px"},children:[l.steps.length," steps"]})]}),e.jsx("div",{style:{marginBottom:"20px",maxHeight:"150px",overflowY:"auto"},children:l.steps.map((p,j)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("span",{style:{background:"#4a9eff",color:"#fff",width:"20px",height:"20px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"600",marginRight:"10px"},children:j+1}),e.jsxs("span",{style:{color:"#e0e0e0",fontSize:"14px"},children:[p.type,p.type==="convert"&&` (${p.settings.format||"jpeg"})`,p.type==="preset"&&` (${p.settings.preset?.name||"preset"})`]})]},j))}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"10px"},children:[e.jsx("button",{onClick:()=>v(l),style:{flex:1,padding:"8px",borderRadius:"6px",background:"linear-gradient(135deg, #4a9eff 0%, #3a8eed 100%)",color:"#fff",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"Use"}),e.jsx("button",{onClick:()=>r(l),style:{flex:1,padding:"8px",borderRadius:"6px",background:"rgba(255,255,255,0.1)",color:"#e0e0e0",border:"1px solid #4a5568",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"Edit"}),e.jsx("button",{onClick:()=>b(l.id),style:{padding:"8px",borderRadius:"6px",background:"rgba(255,69,69,0.1)",color:"#ff6b6b",border:"1px solid #ff6b6b",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"Delete"})]}),e.jsxs("div",{style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid rgba(255,255,255,0.05)",color:"#a0a0a0",fontSize:"12px"},children:["Created: ",new Date(l.createdAt).toLocaleDateString()]})]},l.id))})]})]})},H=({originalImage:v,editedImage:m,initialPosition:y=50,onPositionChange:o,className:g=""})=>{const[d,f]=s.useState(y),[a,u]=s.useState(!1),h=s.useRef(null),b=s.useCallback(c=>{if(h.current){const C=h.current.getBoundingClientRect(),P=c-C.left,R=Math.max(0,Math.min(100,P/C.width*100));f(R),o&&o(R)}},[o]),r=s.useCallback(c=>{u(!0),b(c.clientX)},[b]),x=s.useCallback(c=>{a&&b(c.clientX)},[a,b]),l=s.useCallback(()=>{u(!1)},[]),p=s.useCallback(c=>{u(!0),b(c.touches[0].clientX)},[b]),j=s.useCallback(c=>{a&&(c.preventDefault(),b(c.touches[0].clientX))},[a,b]),k=s.useCallback(()=>{u(!1)},[]);return O.useEffect(()=>{if(a)return document.addEventListener("mousemove",x),document.addEventListener("mouseup",l),document.addEventListener("touchmove",j,{passive:!1}),document.addEventListener("touchend",k),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",l),document.removeEventListener("touchmove",j),document.removeEventListener("touchend",k)}},[a,x,l,j,k]),e.jsxs("div",{ref:h,className:`image-slider ${g}`,style:{position:"relative",width:"100%",height:"100%",cursor:a?"ew-resize":"default"},children:[e.jsx("div",{className:"edited-image",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",clipPath:`polygon(${d}% 0, 100% 0, 100% 100%, ${d}% 100%)`,zIndex:2},children:e.jsx("img",{src:m,alt:"Edited",style:{width:"100%",height:"100%",objectFit:"cover",userSelect:"none",pointerEvents:"none"}})}),e.jsx("div",{className:"original-image",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1},children:e.jsx("img",{src:v,alt:"Original",style:{width:"100%",height:"100%",objectFit:"cover",userSelect:"none",pointerEvents:"none"}})}),e.jsxs("div",{className:"slider-handle",style:{position:"absolute",top:0,left:`${d}%`,transform:"translateX(-50%)",height:"100%",width:"3px",backgroundColor:"#fff",zIndex:10,cursor:"ew-resize",boxShadow:"0 0 10px rgba(0,0,0,0.7)",pointerEvents:"none"},onMouseDown:r,onTouchStart:p,children:[e.jsx("div",{style:{position:"absolute",top:"10px",left:"50%",transform:"translateX(-50%)",width:"0",height:"0",borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderBottom:"12px solid #fff",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"}}),e.jsxs("div",{className:"handle-knob",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",border:"3px solid #4CAF50"},children:[e.jsx("div",{style:{position:"absolute",left:"12px",width:"0",height:"0",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderRight:"8px solid #4CAF50"}}),e.jsx("div",{style:{position:"absolute",right:"12px",width:"0",height:"0",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderLeft:"8px solid #4CAF50"}})]}),e.jsx("div",{style:{position:"absolute",bottom:"10px",left:"50%",transform:"translateX(-50%)",width:"0",height:"0",borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:"12px solid #fff",filter:"drop-shadow(0 -2px 4px rgba(0,0,0,0.3))"}})]})]})},X=({workflows:v=[],presets:m=[],onWorkflowsChange:y})=>{const[o,g]=s.useState([]),[d,f]=s.useState([]),[a,u]=s.useState(null),[h,b]=s.useState(!1),[r,x]=s.useState(0),[l,p]=s.useState(!1),[j,k]=s.useState(50),[c,C]=s.useState({total:0,completed:0,failed:0});s.useRef(null);const P=s.useCallback(t=>{const n=t.filter(i=>i.type.startsWith("image/")||E(i.name));if(n.length!==t.length){const i=t.length-n.length;alert(`${i} unsupported file${i!==1?"s":""} were ignored. Only image files are supported.`)}g(i=>[...i,...n])},[]),R=s.useCallback(t=>{g(n=>n.filter((i,w)=>w!==t))},[]),z=s.useCallback(async(t,n)=>{try{let i=t;if(E(t.name)){const W=await $(t,{outputFormat:"jpeg",quality:.95,enhanceQuality:!0,maxWidth:4e3,maxHeight:4e3});i=new File([await fetch(W.url).then(D=>D.blob())],t.name.replace(/\.[^/.]+$/,".jpg"),{type:"image/jpeg"})}const w=n.steps.find(W=>W.type==="preset");if(!w)throw new Error("No preset step found in workflow");const N=m.find(W=>W.id===w.presetId);if(!N)throw new Error("Preset not found");return(await T([i],N.settings,{quality:.9}))[0]}catch(i){throw console.error("Error processing file:",i),i}},[m]),B=s.useCallback(async()=>{if(o.length===0){alert("Please select files to process");return}if(!a){alert("Please select a workflow");return}if(a.steps.length===0){alert("Selected workflow has no steps");return}b(!0),x(0),f([]),C({total:o.length,completed:0,failed:0});try{const t=[];for(let n=0;n<o.length;n++)try{const i=await z(o[n],a),w={id:Date.now()+n,originalFile:o[n],name:o[n].name.replace(/\.[^/.]+$/,"")+"_processed.jpg",size:i.size||o[n].size,status:"completed",downloadUrl:i.dataUrl,previewUrl:i.dataUrl};t.push(w),f(N=>[...N,w]),x((n+1)/o.length*100),C(N=>({...N,completed:N.completed+1}))}catch(i){console.error(`Error processing file ${o[n].name}:`,i);const w={id:Date.now()+n,originalFile:o[n],name:o[n].name,size:o[n].size,status:"failed",error:i.message};t.push(w),f(N=>[...N,w]),C(N=>({...N,failed:N.failed+1}))}p(!0)}catch(t){console.error("Batch processing failed:",t),alert("Batch processing failed: "+t.message)}finally{b(!1)}},[o,a,z]),F=s.useCallback(async()=>{try{const t=d.filter(w=>w.status==="completed");if(t.length===0){alert("No successfully processed files to download");return}const n=t[0],i=document.createElement("a");i.href=n.downloadUrl,i.download=n.name,document.body.appendChild(i),i.click(),document.body.removeChild(i),alert(`Downloading ${t.length} files. In a full implementation, this would be a ZIP file.`)}catch(t){console.error("Error downloading files:",t),alert("Error downloading files: "+t.message)}},[d]),A=s.useCallback(()=>{g([]),f([]),u(null),p(!1),x(0),C({total:0,completed:0,failed:0})},[]),L=s.useCallback(t=>m.find(n=>n.id===t),[m]);return e.jsx("div",{className:"batch-workflow-processor",children:l?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Processing Results"}),e.jsxs("p",{className:"text-gray-400",children:[c.completed," completed, ",c.failed," failed"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:F,className:"px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-md shadow transition-all",children:"Download All"}),e.jsx("button",{onClick:A,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-md transition-all",children:"Process More"})]})]}),h&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-white",children:"Processing..."}),e.jsxs("span",{className:"text-gray-400",children:[Math.round(r),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2.5 rounded-full transition-all duration-300",style:{width:`${r}%`}})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(t=>e.jsx("div",{className:"bg-gray-700 rounded-lg overflow-hidden border border-gray-600",children:t.status==="completed"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-48",children:e.jsx(H,{originalImage:URL.createObjectURL(t.originalFile),editedImage:t.previewUrl,initialPosition:j,onPositionChange:k})}),e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:t.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(t.size/1024).toFixed(1)," KB"]})]}),e.jsx("a",{href:t.downloadUrl,download:t.name,className:"text-blue-400 hover:text-blue-300 flex-shrink-0 ml-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})]}):e.jsxs("div",{className:"h-48 flex flex-col items-center justify-center p-4 text-center",children:[e.jsx("div",{className:"text-red-500 mb-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-white font-medium truncate mb-1",children:t.name}),e.jsx("p",{className:"text-red-400 text-sm mb-2",children:"Processing failed"}),e.jsx("p",{className:"text-gray-400 text-xs",children:t.error})]})},t.id))})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Upload Images"}),e.jsx(U,{onFilesSelected:P,multiple:!0,accept:"image/*",className:"mb-6"}),o.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-white",children:["Selected Files (",o.length,")"]}),e.jsx("button",{onClick:()=>g([]),className:"text-red-400 hover:text-red-300 text-sm",children:"Clear All"})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:o.map((t,n)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded p-3",children:[e.jsxs("div",{className:"flex items-center min-w-0",children:[t.type.startsWith("image/")&&e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("img",{src:URL.createObjectURL(t),alt:t.name,className:"w-10 h-10 object-cover rounded"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-white text-sm truncate",children:t.name}),e.jsxs("p",{className:"text-gray-400 text-xs",children:[(t.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsx("button",{onClick:()=>R(n),className:"text-red-400 hover:text-red-300 ml-2",children:"×"})]},n))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Select Workflow"}),v.length===0?e.jsxs("div",{className:"text-center py-4 bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-gray-400",children:"No workflows available"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Create a workflow first"})]}):e.jsx("div",{className:"space-y-3",children:v.filter(t=>t.isActive).map(t=>{const n=t.steps.find(w=>w.type==="preset"),i=n?L(n.presetId):null;return e.jsxs("div",{onClick:()=>u(t),className:`p-4 rounded-lg cursor-pointer border transition-all ${a?.id===t.id?"bg-blue-900 border-blue-500 shadow-lg":"bg-gray-700 border-gray-600 hover:bg-gray-600 hover:border-gray-500"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-white font-medium",children:t.name}),a?.id===t.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-2",children:[t.steps.length," step",t.steps.length!==1?"s":""]}),i&&e.jsxs("div",{className:"flex items-center text-xs text-gray-300",children:[e.jsx("span",{className:"bg-gray-600 px-2 py-1 rounded mr-2",children:"Preset"}),e.jsx("span",{children:i.name})]})]},t.id)})})]}),e.jsx("button",{onClick:B,disabled:o.length===0||!a||h,className:`w-full py-3 rounded-lg font-medium transition-all ${o.length===0||!a||h?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl"}`,children:h?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing... ",Math.round(r),"%"]}):"Process Images"})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(I,{workflows:v,presets:m,onWorkflowsChange:y})})]})})},Q=()=>{const[v,m]=s.useState([]),[y,o]=s.useState([]),[g,d]=s.useState(!0),[f,a]=s.useState(null),[u,h]=s.useState(!1);s.useEffect(()=>{(()=>{try{const l=localStorage.getItem("imageEditorWorkflows");if(l){const k=JSON.parse(l).map(c=>({...c,isActive:c.isActive!==void 0?c.isActive:!0,steps:c.steps||[],createdAt:c.createdAt||new Date().toISOString()}));m(k)}const p=localStorage.getItem("imageEditorPresets");if(p){const k=JSON.parse(p).map(c=>({...c,id:c.id||Date.now()+Math.random(),createdAt:c.createdAt||new Date().toISOString()}));o(k)}}catch(l){console.error("Failed to load stored data",l)}finally{d(!1)}})()},[]);const b=x=>{m(x),localStorage.setItem("imageEditorWorkflows",JSON.stringify(x))},r=()=>{h(!u)};return g?e.jsxs("div",{className:"page",children:[e.jsx("nav",{className:"top-navigation",children:e.jsxs("div",{className:"nav-container",children:[e.jsx("div",{className:"logo",children:"RawConverter"}),e.jsx("button",{className:"menu-toggle",onClick:r,children:"☰"}),e.jsxs("div",{className:`nav-links ${u?"active":""}`,children:[e.jsx(S,{to:"/",className:"nav-link",onClick:()=>h(!1),children:"Home"}),e.jsx(S,{to:"/editor",className:"nav-link",onClick:()=>h(!1),children:"Editor"}),e.jsx(S,{to:"/compression",className:"nav-link",onClick:()=>h(!1),children:"Compression"}),e.jsx(S,{to:"/raw-convert",className:"nav-link",onClick:()=>h(!1),children:"RAW Convert"})]})]})}),e.jsx("div",{className:"page-content",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})})})]}):e.jsxs("div",{className:"page",children:[e.jsx("nav",{className:"top-navigation",children:e.jsxs("div",{className:"nav-container",children:[e.jsx("div",{className:"logo",children:"RawConverter"}),e.jsx("button",{className:"menu-toggle",onClick:r,children:"☰"}),e.jsxs("div",{className:`nav-links ${u?"active":""}`,children:[e.jsx(S,{to:"/",className:"nav-link",onClick:()=>h(!1),children:"Home"}),e.jsx(S,{to:"/editor",className:"nav-link",onClick:()=>h(!1),children:"Editor"}),e.jsx(S,{to:"/compression",className:"nav-link",onClick:()=>h(!1),children:"Compression"}),e.jsx(S,{to:"/raw-convert",className:"nav-link",onClick:()=>h(!1),children:"RAW Convert"})]})]})}),e.jsx("div",{className:"page-content",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Professional Workflow Management"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"Streamline your image processing with automated workflows and batch operations"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400 mb-2",children:v.length}),e.jsx("div",{className:"text-gray-400",children:"Workflows"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400 mb-2",children:y.length}),e.jsx("div",{className:"text-gray-400",children:"Presets"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-400 mb-2",children:v.filter(x=>x.isActive).length}),e.jsx("div",{className:"text-gray-400",children:"Active Workflows"})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx(I,{onWorkflowSelect:a})}),f&&e.jsx("div",{className:"mb-8",children:e.jsx(X,{workflows:v,presets:y,onWorkflowsChange:b,selectedWorkflow:f})}),e.jsxs("div",{className:"mt-12 bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"How Workflows Work"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl mb-3",children:"1️⃣"}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Create Workflow"}),e.jsx("p",{className:"text-gray-400",children:"Define a sequence of processing steps including preset application, format conversion, and resizing."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl mb-3",children:"2️⃣"}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Upload Images"}),e.jsx("p",{className:"text-gray-400",children:"Select multiple images to process with your workflow. Supports RAW, JPEG, PNG, and other formats."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl mb-3",children:"3️⃣"}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Process & Download"}),e.jsx("p",{className:"text-gray-400",children:"Execute your workflow and download all processed images in a single ZIP file."})]})]})]})]})})]})};export{Q as default};
